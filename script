local Player = game.Players.LocalPlayer
local Character = Player.Character or Player.CharacterAdded:Wait()
local Humanoid = Character:WaitForChild("Humanoid")

-- Создаем интерфейс с подсказками
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "TSB_AttackHUD"
screenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")

local frame = Instance.new("Frame")
frame.Size = UDim2.new(0.25, 0, 0.2, 0)
frame.Position = UDim2.new(0.73, 0, 0.05, 0)
frame.BackgroundTransparency = 0.8
frame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
frame.Parent = screenGui

local title = Instance.new("TextLabel")
title.Text = "THE STRONGEST BATTLEGROUNDS"
title.TextColor3 = Color3.fromRGB(255, 215, 0)
title.Font = Enum.Font.GothamBlack
title.Size = UDim2.new(1, 0, 0.2, 0)
title.BackgroundTransparency = 1
title.Parent = frame

-- Подсказки по управлению (стиль TSB)
local controls = {
    {Key = "Q", Desc = "Light Attack (Быстрая атака)", Color = Color3.fromRGB(255, 100, 100)},
    {Key = "E", Desc = "Heavy Attack (Сильная атака)", Color = Color3.fromRGB(255, 50, 50)},
    {Key = "R", Desc = "Special (Особая атака)", Color = Color3.fromRGB(100, 255, 100)},
    {Key = "F", Desc = "Block (Блок)", Color = Color3.fromRGB(100, 100, 255)}
}

for i, control in ipairs(controls) do
    local label = Instance.new("TextLabel")
    label.Text = string.format("[%s] - %s", control.Key, control.Desc)
    label.TextColor3 = control.Color
    label.Font = Enum.Font.GothamBold
    label.Size = UDim2.new(1, 0, 0.15, 0)
    label.Position = UDim2.new(0, 10, 0.2 + (i * 0.15), 0)
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.BackgroundTransparency = 1
    label.Parent = frame
end

-- Анимации из The Strongest Battlegrounds (ID нужно заменить на реальные)
local TSB_Animations = {
    LightAttack = {
        AnimId = "rbxassetid://9124234871", -- Заменить на реальный ID
        Damage = 15,
        Cooldown = 0.6,
        Effect = "Slash"
    },
    HeavyAttack = {
        AnimId = "rbxassetid://9124236723", -- Заменить на реальный ID
        Damage = 30,
        Cooldown = 1.8,
        Effect = "Explosion"
    },
    SpecialAttack = {
        AnimId = "rbxassetid://9124238912", -- Заменить на реальный ID
        Damage = 50,
        Cooldown = 5,
        Effect = "Special"
    },
    Block = {
        AnimId = "rbxassetid://9124240567", -- Заменить на реальный ID
        Duration = 2
    }
}

-- Загрузка анимаций
for name, data in pairs(TSB_Animations) do
    local anim = Instance.new("Animation")
    anim.AnimationId = data.AnimId
    data.Track = Humanoid:LoadAnimation(anim)
    data.Track.Priority = Enum.AnimationPriority.Action
    data.LastUsed = 0
end

-- Эффекты атак
local function CreateEffect(effectType, position)
    if effectType == "Slash" then
        -- Эффект удара мечом
        local part = Instance.new("Part")
        part.Size = Vector3.new(3, 3, 0.2)
        part.CFrame = CFrame.new(position) * CFrame.Angles(0, math.rad(90), 0)
        part.Material = Enum.Material.Neon
        part.Color = Color3.fromRGB(255, 100, 100)
        part.Anchored = true
        part.CanCollide = false
        part.Transparency = 0.5
        
        local mesh = Instance.new("SpecialMesh", part)
        mesh.MeshType = Enum.MeshType.FileMesh
        mesh.MeshId = "rbxassetid://9124234871" -- Модель эффекта
        
        game.Debris:AddItem(part, 0.5)
        part.Parent = workspace
    elseif effectType == "Explosion" then
        -- Эффект взрыва
        local explosion = Instance.new("Explosion")
        explosion.Position = position
        explosion.BlastPressure = 0
        explosion.BlastRadius = 8
        explosion.ExplosionType = Enum.ExplosionType.NoCraters
        explosion.Parent = workspace
    end
end

-- Система атак
local function ExecuteAttack(attackType)
    local attack = TSB_Animations[attackType]
    if not attack then return end
    
    -- Проверка кулдауна
    if os.clock() - attack.LastUsed < attack.Cooldown then
        return
    end
    attack.LastUsed = os.clock()
    
    -- Проигрываем анимацию
    attack.Track:Play()
    
    -- Если это блок - просто играем анимацию
    if attackType == "Block" then
        return
    end
    
    -- Поиск цели
    local origin = Character.HumanoidRootPart.Position
    local direction = Character.HumanoidRootPart.CFrame.LookVector * 15
    local params = RaycastParams.new()
    params.FilterDescendantsInstances = {Character}
    
    local result = workspace:Raycast(origin, direction, params)
    if result and result.Instance then
        local target = result.Instance:FindFirstAncestorOfClass("Model")
        if target and target:FindFirstChild("Humanoid") then
            -- Наносим урон
            target.Humanoid:TakeDamage(attack.Damage)
            CreateEffect(attack.Effect, result.Position)
            
            -- Тряска камеры
            if game:GetService("RunService"):IsClient() then
                local camera = workspace.CurrentCamera
                local shake = attack.Damage / 15
                for i = 1, 5 do
                    camera.CFrame = camera.CFrame * CFrame.new(
                        math.random(-shake, shake)/10,
                        math.random(-shake, shake)/10,
                        0
                    )
                    task.wait()
                end
            end
        end
    end
end

-- Привязка к клавишам
game:GetService("UserInputService").InputBegan:Connect(function(input, _)
    if input.KeyCode == Enum.KeyCode.Q then
        ExecuteAttack("LightAttack")
    elseif input.KeyCode == Enum.KeyCode.E then
        ExecuteAttack("HeavyAttack")
    elseif input.KeyCode == Enum.KeyCode.R then
        ExecuteAttack("SpecialAttack")
    elseif input.KeyCode == Enum.KeyCode.F then
        ExecuteAttack("Block")
    end
end)

-- Система стамины (опционально)
local stamina = 100
local maxStamina = 100

local staminaText = Instance.new("TextLabel")
staminaText.Text = string.format("STAMINA: %d/%d", stamina, maxStamina)
staminaText.TextColor3 = Color3.fromRGB(100, 255, 100)
staminaText.Font = Enum.Font.GothamBlack
staminaText.Size = UDim2.new(1, 0, 0.15, 0)
staminaText.Position = UDim2.new(0, 0, 0.85, 0)
staminaText.BackgroundTransparency = 1
staminaText.Parent = frame

-- Восстановление стамины
game:GetService("RunService").Heartbeat:Connect(function()
    stamina = math.min(stamina + 0.5, maxStamina)
    staminaText.Text = string.format("STAMINA: %d/%d", stamina, maxStamina)
end)

print("✅ TSB Combat System loaded! Controls in top-right corner.")
